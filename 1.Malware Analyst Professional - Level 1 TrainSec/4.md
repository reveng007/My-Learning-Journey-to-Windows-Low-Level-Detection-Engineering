# Dissecting FlawedAmmyy: Static Analysis

## 1. Opening Sample in Hex Editor:

<details><summary>See Details</summary>

<img width="1396" height="690" alt="image" src="https://github.com/user-attachments/assets/c8af1d2f-2126-48d4-bb02-a11f23f9f32b" />

### Checking IAT in Hex Editor:
> ### We can see what are the probable API which can be used by the malware (all are imported but may happen some are not used.)

<img width="1536" height="941" alt="image" src="https://github.com/user-attachments/assets/5297228e-af15-4936-9678-40faa14c6852" />

### At the very End, we can see that a pattern is there, `6F` is being repeated and also random chars are present without presence of any spaces (Indicator of obfuscation/Encryption).

<img width="2143" height="1145" alt="image" src="https://github.com/user-attachments/assets/37bb9183-5116-4e6d-8c45-4fd60649e044" />

<img width="1399" height="696" alt="image" src="https://github.com/user-attachments/assets/660a3e19-e536-49c2-9c69-09453c87bcd9" />

### At the very End, we can see Manifest. It won't ask for Administrative Prompt/UAC Prompt.

<img width="1002" height="141" alt="image" src="https://github.com/user-attachments/assets/e720f37e-158c-47ab-8eb5-78db9b5f729e" />

</details>

## 2. String extractions:

<details><summary>See Details</summary>

### 1. Process Names, somehow may be related to `createtoolhelp32snapshot` WinAPI

<img width="1862" height="821" alt="image" src="https://github.com/user-attachments/assets/59827535-a938-407f-8704-1668cd3fe676" />

<img width="380" height="272" alt="image" src="https://github.com/user-attachments/assets/86715c8e-6d3b-4e11-ac95-0754537688c0" />

### This revelation of Window APIs here also says that API hashing type functions are not present in here. Check [Resources for learning about reversing API hashed binary](https://github.com/reveng007/My-Learning-Journey-to-Windows-Low-Level-Detection-Engineering/blob/main/1.Malware%20Analyst%20Professional%20-%20Level%201%20TrainSec/4.md#resources).

</details>

## 3. PE Parsing via PE Bear:

<details><summary>See Details</summary>

### 1. Rich Header Shows what type of linker and Compiler is used.

<img width="1948" height="1200" alt="image" src="https://github.com/user-attachments/assets/44484d64-a821-45fb-8669-09ece4a6cb92" />

</details>

## Resources:
1. Malware Analysis : [YT - Malware Evasion Techniques: API Unhooking + API Hashing](https://www.youtube.com/watch?v=mjF9LFIAgF8)
