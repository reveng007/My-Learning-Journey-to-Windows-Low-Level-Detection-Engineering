# 3.Identifying Malicious Functionality:

## 1. Opening in PE Studio: VT Scans

<img width="2148" height="1190" alt="Clipboard_2025-11-29-12-24-00" src="https://github.com/user-attachments/assets/7e6bddf1-8d07-4521-a7b0-51bf3b74e1c3" />

## 2. It also shows that it has an embedded file within it.

| 1 | 2 |
| - | - |
| <img width="1398" height="746" alt="Clipboard_2025-11-29-12-26-09" src="https://github.com/user-attachments/assets/2e111fe8-30b4-4b21-b453-c004aa643032" /> | **Offset of the embedded file is also given (Double Click)** <img width="1398" height="746" alt="Clipboard_2025-11-29-12-27-20" src="https://github.com/user-attachments/assets/33eedba3-aa38-42ff-b84b-88b9af2c007e" /> |

## 3. File Ratio Huge Variation

<img width="2146" height="1192" alt="Clipboard_2025-11-29-12-37-29" src="https://github.com/user-attachments/assets/95edf10b-db62-4dbb-9cb8-cca419943625" />

## 4. Executable Permission in `.rdata (Read Data)` section which should not be in normal scenario : IOC

<img width="2140" height="1188" alt="Clipboard_2025-11-29-14-12-26" src="https://github.com/user-attachments/assets/987ce77a-abd3-426e-96d0-9fed6fcd795f" />

## 5. Another IOC can be : Multiple Executable Sections (FP: .NET executables)

<img width="2148" height="1190" alt="Clipboard_2025-11-29-14-19-08" src="https://github.com/user-attachments/assets/98bf2a2c-8334-45a7-aab3-ea1292c66629" />

## 6. Flagged Windows Apis can be another IOC, which need further checking.

| 1 | 2 |
| - | - |
| <img width="2150" height="1184" alt="Clipboard_2025-11-29-14-21-08" src="https://github.com/user-attachments/assets/db4e91c4-af9a-442e-9ed8-20b1889d4738" /> | <img width="2140" height="1182" alt="Clipboard_2025-11-29-14-24-36" src="https://github.com/user-attachments/assets/9cd326fc-2880-4d06-9eef-faa7a457d9ba" /> |

## 7. Further Validation of those APIS present in IAT, whether they are used by the sample or not via IDA.

### Step1: Open in IDA

<img width="1478" height="576" alt="Clipboard_2025-11-29-14-38-54" src="https://github.com/user-attachments/assets/350a83c4-51df-4661-961b-8e344f9a3d6f" />

### Step2: Go to the Imports

<img width="1487" height="747" alt="Clipboard_2025-11-29-14-41-33" src="https://github.com/user-attachments/assets/3880cb10-608e-4b33-ad97-01376ab5223f" />

### Step3: Validation of usage of WinAPI (Cause Not all times, Imported WinAPIs are being used)

| Validating of usage of `CreateServiceA` | Validation of usage of `Process32First` |
| - | - |
| Double Click on it. <img width="552" height="280" alt="Clipboard_2025-11-29-14-44-52" src="https://github.com/user-attachments/assets/8ad71a1b-cfc9-47bc-8a13-9d8b15b71692" /> | Double Click on it. <img width="586" height="48" alt="Clipboard_2025-11-29-14-49-17" src="https://github.com/user-attachments/assets/bcae9155-3bd7-41c7-ac76-594b43236434" /> |
| Now Select one of the Winapi Calls. <img width="1430" height="50" alt="Clipboard_2025-11-29-14-46-20" src="https://github.com/user-attachments/assets/6086a19f-58a9-45fd-a46f-ae2ec30060fa" /> | Now Select one of the Winapi Calls. |
| And press `X` (for cross-reference) <img width="359" height="145" alt="Clipboard_2025-11-29-14-47-08" src="https://github.com/user-attachments/assets/1ee9929b-26cb-4379-84b1-d4c28376642c" /> -> This Means, this WinAPI was not being used. | And press `X` (for cross-reference) <img width="1563" height="631" alt="Clipboard_2025-11-29-14-50-03" src="https://github.com/user-attachments/assets/a6c88385-8b66-4d1c-a05a-219ca725741c" /> -> This Means, this WinAPI is used. <img width="1484" height="692" alt="Clipboard_2025-11-29-14-56-42" src="https://github.com/user-attachments/assets/1972907a-9fab-42cc-a462-ba2bc31a6e8d" /> | 
| _ | We can also put BP at the top of the target WinAPI, then start execution of the sample, to see we hit any breakpoint or not. | 

### Step4: Another way of Validation of usage of WinAPI is via usage of `SpeakEasy` (may show FalsePostive sometimes) and `ApiMonitor`.


